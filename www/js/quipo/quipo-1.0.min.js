//	QuipoJS 1.1 ~ Copyright (c) 2012 Cedrik Boudreau. Released under MIT license.
//	http://www.studioquipo.com
var Qjs=function(){function E(e,n){e=e||t;e.__proto__=E.prototype;e.selector=n||"";return e}function S(e,t){return e?E(S.getDomainSelector(e,t),e):E()}function x(e){return e.filter(function(e){return e!==undefined&&e!==null})}function T(e){return e.length>0?[].concat.apply([],e):e}function N(){var e=navigator.userAgent;var t={};t.browser=C(e);t.os=k(e);t.isMobile=t.os?true:false;t.screen=L();return t}function C(e){var t=e.match(y);return t?t[0]:e}function k(e){var t;for(os in b){var n=e.match(b[os]);if(n){t={name:os==="iphone"||os==="ipad"?"ios":os,version:n[2].replace("_",".")};break}}return t}function L(){return{width:window.innerWidth,height:window.innerHeight}}function A(e){var t=[];while(e.length>0){e=S.map(e,function(e){if((e=e.parentNode)&&e!==document&&t.indexOf(e)<0){t.push(e);return e}})}return t}function O(e,t){return t===undefined?S(e):S(e).filter(t)}function M(e,t){var n=t.split(/\s+/g);return n.indexOf(e)>=0}function _(e,t){return document.defaultView.getComputedStyle(e,"")[t]}function D(e,t){if(e.status===200||e.status===0){if(t.async){var n=F(e,t);P(n,e,t)}}else{H("QjsJS » $.ajax",e,t)}}function P(e,t,n){n.success.call(n.context,e,t)}function H(e,t,n){n.error.call(n.context,e,t,n)}function B(e,t){if(t.contentType)t.headers["Content-Type"]=t.contentType;if(t.dataType)t.headers["Accept"]=s[t.dataType];for(header in t.headers){e.setRequestHeader(header,t.headers[header])}}function j(e,t){e.onreadystatechange={};e.abort();H("QjsJS » $.ajax : timeout exceeded",e,t)}function F(e,t){var n=e.responseText;if(n){if(t.dataType===i.MIME){try{n=JSON.parse(n)}catch(r){n=r;H("Parse Error",e,t)}}else if(t.dataType==="xml"){n=e.responseXML}}return n}function I(e){return/=\?/.test(e)}function q(e,t,n,r,i){t=z(t);var s=U(e);var o=c[s]||(c[s]=[]);var u=i&&i(n,t);var a={event:t,callback:n,selector:r,proxy:W(u,n,e),delegate:u,index:o.length};o.push(a);e.addEventListener(a.event,a.proxy,false)}function R(e,t,n,r){t=z(t);var i=U(e);X(i,t,n,r).forEach(function(t){delete c[i][t.index];e.removeEventListener(t.event,t.proxy,false)})}function U(e){return e._id||(e._id=l++)}function z(e){var t=S.isMobile()?e:p[e];return t||e}function W(e,t,n){var t=e||t;var r=function(e){var r=t.apply(n,[e].concat(e.data));if(r===false){e.preventDefault()}return r};return r}function X(e,t,n,r){return(c[e]||[]).filter(function(e){return e&&(!t||e.event==t)&&(!n||e.fn==n)&&(!r||e.selector==r)})}function V(e){var t=S.extend({originalEvent:e},e);S.each(h,function(n,r){t[n]=function(){this[r]=function(){return true};return e[n].apply(e,arguments)};t[r]=function(){return false}});return t}function $(){var e=S(document.body);e.bind("touchstart",J);e.bind("touchmove",K);e.bind("touchend",Q);e.bind("touchcancel",G)}function J(e){var t=Date.now();var n=t-(d.last||t);var r=S.isMobile()?e.touches[0]:e;v&&clearTimeout(v);d={el:S(Y(r.target)),x1:r.pageX,y1:r.pageY,isDoubleTap:n>0&&n<=250?true:false,last:t};setTimeout(et,m)}function K(e){var t=S.isMobile()?e.touches[0]:e;d.x2=t.pageX;d.y2=t.pageY}function Q(e){if(d.isDoubleTap){d.el.trigger("doubleTap");d={}}else if(d.x2>0||d.y2>0){(Math.abs(d.x1-d.x2)>30||Math.abs(d.y1-d.y2)>30)&&d.el.trigger("swipe")&&d.el.trigger("swipe"+Z(d.x1,d.x2,d.y1,d.y2));d.x1=d.x2=d.y1=d.y2=d.last=0;d={}}else{if(d.el!==undefined){d.el.trigger("tap")}v=setTimeout(function(){v=null;d={}},250)}}function G(e){d={};clearTimeout(v)}function Y(e){return"tagName"in e?e:e.parentNode}function Z(e,t,n,r){var i=Math.abs(e-t);var s=Math.abs(n-r);if(i>=s){return e-t>0?"Left":"Right"}else{return n-r>0?"Up":"Down"}}function et(){if(d.last&&Date.now()-d.last>=m){d.el.trigger("longTap");d={}}}var e=Object.prototype,t=[],n="parentNode",r=t.slice,i={TYPE:"GET",MIME:"json"},s={script:"text/javascript, application/javascript",json:"application/json",xml:"application/xml, text/xml",html:"text/html",text:"text/plain"},o=0,u=["touch","tap"],a={touch:"touchstart",tap:"tap"},f=/complete|loaded|interactive/,l=1,c={},h={preventDefault:"isDefaultPrevented",stopImmediatePropagation:"isImmediatePropagationStopped",stopPropagation:"isPropagationStopped"},p={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",tap:"click",doubletap:"dblclick",orientationchange:"resize"},d={},v,m=750,g=["swipe","swipeLeft","swipeRight","swipeUp","swipeDown","doubleTap","longTap"],y=/WebKit\/([\d.]+)/,b={android:/(Android)\s+([\d.]+)/,ipad:/(iPad).*OS\s([\d_]+)/,iphone:/(iPhone\sOS)\s([\d_]+)/,blackberry:/(BlackBerry).*Version\/([\d.]+)/,webos:/(webOS|hpwOS)[\s\/]([\d.]+)/},w=null;S.extend=function(e,t){Array.prototype.slice.call(arguments,1).forEach(function(t){for(key in t)e[key]=t[key]});return e};S.each=function(e,t){var n,r;if(S.toType(e)==="array")for(n=0;n<e.length;n++){if(t.call(e[n],n,e[n])===false)return e}else for(r in e){if(t.call(e[r],r,e[r])===false)return e}return e};S.mix=function(){var e={};for(var t=0,n=arguments.length;t<n;t++){var r=arguments[t];for(var i in r){if(S.isOwnProperty(r,i)&&r[i]!==undefined){e[i]=r[i]}}}return e};S.toType=function(t){return e.toString.call(t).match(/\s([a-z|A-Z]+)/)[1].toLowerCase()};S.isOwnProperty=function(t,n){return e.hasOwnProperty.call(t,n)};S.getDomainSelector=function(e,t){var n=null;var r=[1,9,11];var i=S.toType(e);if(i==="array"){n=x(e)}else if(i==="string"){n=S.query(t||document,e)}else if(r.indexOf(e.nodeType)>=0||e===window){n=[e];e=null}return n};S.map=function(e,t){var n=[];var r;var i;if(S.toType(e)==="array"){for(r=0;r<e.length;r++){var s=t(e[r],r);if(s!=null)n.push(s)}}else{for(i in e){s=t(e[i],i);if(s!=null)n.push(s)}}return T(n)};S.isMobile=function(){w=w||N();return w.isMobile};S.environment=function(){w=w||N();return w};S.isOnline=function(){return navigator.onLine};S.query=function(e,t){if(S.toType(e)==="array"){var n=[];for(var r=0,i=e.length;r<i;r++){n=n.concat(Array.prototype.slice.call(e[r].querySelectorAll(t)))}return n}return Array.prototype.slice.call(e.querySelectorAll(t))};S.ajaxSettings={type:i.TYPE,async:true,success:{},error:{},context:null,dataType:i.MIME,headers:{},xhr:function(){return new window.XMLHttpRequest},crossDomain:false,timeout:0};S.ajax=function(e){var t=S.mix(S.ajaxSettings,e);if(I(t.url))return S.jsonp(t);var n=t.xhr();n.onreadystatechange=function(){if(n.readyState===4){clearTimeout(r);D(n,t)}};n.open(t.type,t.url,t.async);B(n,t);if(t.timeout>0){var r=setTimeout(function(){j(n,t)},t.timeout)}n.send(t.data);return t.async?n:F(n,t)};S.jsonp=function(e){var t="jsonp"+ ++o;var n=document.createElement("script");var r={abort:function(){S(n).remove();if(t in window)window[t]={}}};var i;window[t]=function(s){clearTimeout(i);S(n).remove();delete window[t];P(s,r,e)};n.src=e.url.replace(/=\?/,"="+t);S("head").append(n);if(e.timeout>0){i=setTimeout(function(){j(r,e)},e.timeout)}return r};S.get=function(e,t,n,r){e+=S.serializeParameters(t);return S.ajax({url:e,success:n,dataType:r})};S.post=function(e,t,n,r){return S.ajax({type:"POST",url:e,data:t,success:n,dataType:r,contentType:"application/x-www-form-urlencoded"})};S.json=function(e,t,n){e+=S.serializeParameters(t);return S.ajax({url:e,success:n,dataType:i.MIME})};S.serializeParameters=function(e){var t="?";for(var n in e){if(e.hasOwnProperty(n)){if(t!=="?")t+="&";t+=n+"="+e[n]}}return t==="?"?"":t};S.Event=function(e,t){var n=document.createEvent("Events");n.initEvent(e,true,true,null,null,null,null,null,null,null,null,null,null,null,null);return n};E.prototype=S.fn={forEach:t.forEach,indexOf:t.indexOf,map:function(e){return S.map(this,function(t,n){return e.call(t,n,t)})},slice:function(){return S(r.apply(this,arguments))},instance:function(e){return this.map(function(){return this[e]})},filter:function(e){return S([].filter.call(this,function(t){return t.parentNode&&S.query(t.parentNode,e).indexOf(t)>=0}))},attr:function(e,t){if(S.toType(e)==="string"&&t===undefined){return this[0].getAttribute(e)}else{return this.each(function(){this.setAttribute(e,t)})}},removeAttr:function(e){return this.each(function(){if(this.nodeType===1)this.removeAttribute(e)})},data:function(e,t){return this.attr("data-"+e,t)},val:function(e){if(S.toType(e)==="string"){return this.each(function(){this.value=e})}else{return this.length>0?this[0].value:null}},show:function(){return this.style("display","block")},hide:function(){return this.style("display","none")},height:function(){var e=this.offset();return e.height},width:function(){var e=this.offset();return e.width},offset:function(){var e=this[0].getBoundingClientRect();return{left:e.left+window.pageXOffset,top:e.top+window.pageYOffset,width:e.width,height:e.height}},remove:function(){return this.each(function(){if(this.parentNode!=null){this.parentNode.removeChild(this)}})},text:function(e){return!e?this[0].textContent:this.each(function(){this.textContent=e})},html:function(e){return S.toType(e)==="string"?this.each(function(){this.innerHTML=e}):this[0].innerHTML},append:function(e){return this.each(function(){if(S.toType(e)==="string"){if(e){var t=document.createElement("div");t.innerHTML=e;this.appendChild(t.firstChild)}}else{this.insertBefore(e)}})},prepend:function(e){return this.each(function(){if(S.toType(e)==="string"){this.innerHTML=e+this.innerHTML}else{var t=this.parentNode;t.insertBefore(e,t.firstChild)}})},empty:function(){return this.each(function(){this.innerHTML=null})},parent:function(e){var t=e?A(this):this.instance(n);return O(t,e)},siblings:function(e){var t=this.map(function(e,t){return Array.prototype.slice.call(t.parentNode.children).filter(function(e){return e!==t})});return O(t,e)},children:function(e){var t=this.map(function(){return Array.prototype.slice.call(this.children)});return O(t,e)},eq:function(e){return e===-1?this.slice(e):this.slice(e,+e+1)},index:function(e){return e?this.indexOf(S(e)[0]):this.parent().children().indexOf(this[0])},get:function(e){return e===undefined?this:this[e]},first:function(){return S(this[0])},last:function(){var e=this.length-1;return S(this[e])},closest:function(e,t){var n=this[0];var r=S(e);if(!r.length)n=null;while(n&&r.indexOf(n)<0){n=n!==t&&n!==document&&n.parentNode}return S(n)},each:function(e){this.forEach(function(t,n){e.call(t,n,t)});return this},addClass:function(e){return this.each(function(){if(!M(e,this.className)){this.className+=" "+e}})},removeClass:function(e){return this.each(function(){if(M(e,this.className)){this.className=this.className.replace(e," ").replace(/\s+/gi," ")}})},toggleClass:function(e){return this.each(function(){if(M(e,this.className)){this.className=this.className.replace(e," ")}else{this.className+=" "+e}})},hasClass:function(e){return M(e,this[0].className)},style:function(e,t){return!t?this[0].style[e]||_(this[0],e):this.each(function(){this.style[e]=t})},on:function(e,t,n){return t===undefined||S.toType(t)==="function"?this.bind(e,t):this.delegate(t,e,n)},off:function(e,t,n){return t===undefined||S.toType(t)==="function"?this.unbind(e,t):this.undelegate(t,e,n)},ready:function(e){if(f.test(document.readyState)){e(S)}else{document.addEventListener("DOMContentLoaded",function(){e(S)},false)}return this},bind:function(e,t){return this.each(function(){q(this,e,t)})},unbind:function(e,t){return this.each(function(){R(this,e,t)})},delegate:function(e,t,n){return this.each(function(r,i){q(i,t,n,e,function(t){return function(n){var r=S(n.target).closest(e,i).get(0);if(r){var s=S.extend(V(n),{currentTarget:r,liveFired:i});return t.apply(r,[s].concat([].slice.call(arguments,1)))}}})})},undelegate:function(e,t,n){return this.each(function(){R(this,t,n,e)})},trigger:function(e){if(S.toType(e)==="string")e=S.Event(e);return this.each(function(){this.dispatchEvent(e)})},serializeArray:function(){var e=[],t;S(r.call(this.get(0).elements)).each(function(){t=S(this);var n=t.attr("type");if(this.nodeName.toLowerCase()!="fieldset"&&!this.disabled&&n!="submit"&&n!="reset"&&n!="button"&&(n!="radio"&&n!="checkbox"||this.checked)){e.push({name:t.attr("name"),value:t.val()})}});return e},serialize:function(){var e=[];this.serializeArray().forEach(function(t){e.push(encodeURIComponent(t.name)+"="+encodeURIComponent(t.value))});return e.join("&")}};u.forEach(function(e){S.fn[e]=function(t){S(document.body).delegate(this.selector,a[e],t);return this}});g.forEach(function(e){S.fn[e]=function(t){return this.on(e,t)}});S(document).ready(function(){$()});return S}();window.Qjs=Qjs;"$"in window||(window.$=Qjs)
